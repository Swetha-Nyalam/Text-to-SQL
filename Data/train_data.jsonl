{"question": "How many trips were recorded in 2010?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE substr(pickup_datetime, 1, 4) = '2010';"}
{"question": "What is the total number of trips with a fare amount greater than $30?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE fare_amount > 30;"}
{"question": "Which month in 2011 had the highest number of trips?", "sql": "SELECT substr(pickup_datetime, 1, 7) AS month, COUNT(*) AS trip_count FROM uber WHERE substr(pickup_datetime, 1, 4) = '2011' GROUP BY month ORDER BY trip_count DESC LIMIT 1;"}
{"question": "What is the maximum fare amount recorded?", "sql": "SELECT MAX(fare_amount) AS max_fare FROM uber;"}
{"question": "What day in 2015 had the fewest number of trips?", "sql": "SELECT substr(pickup_datetime, 1, 10) AS trip_date, COUNT(*) AS trip_count FROM uber WHERE substr(pickup_datetime, 1, 4) = '2015' GROUP BY trip_date ORDER BY trip_count ASC LIMIT 1;"}
{"question": "What is the median fare amount of all trips?", "sql": "SELECT AVG(fare_amount) AS median_fare FROM (SELECT fare_amount FROM uber ORDER BY fare_amount LIMIT 2 - (SELECT COUNT(*) FROM uber) % 2 OFFSET (SELECT (COUNT(*) - 1) / 2 FROM uber));"}
{"question": "Was there any trip recorded on December 25th, 2014?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE DATE(pickup_datetime) = '2014-12-25';"}
{"question": "What is the total revenue generated in 2014?", "sql": "SELECT SUM(fare_amount) AS total_revenue FROM uber WHERE strftime('%Y', pickup_datetime) = '2014';"}
{"question": "Which city generated the highest revenue from trips with the minimum passenger count?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = (SELECT MIN(passenger_count) FROM uber) GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "Which city had the highest number of trips where the distance was over 10 miles?", "sql": "SELECT pickup_city FROM uber WHERE distance_miles > 10 GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city had the highest number of drop-offs in 2015?", "sql": "SELECT dropoff_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' GROUP BY dropoff_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "How many trips were recorded in September 2010?", "sql": "SELECT COUNT(*) AS total_trips FROM uber WHERE strftime('%Y-%m', pickup_datetime) = '2010-09';"}
{"question": "What is the total distance covered by all trips in New Jersey?", "sql": "SELECT SUM(distance_miles) AS total_distance FROM uber WHERE pickup_statecode = 'NJ';"}
{"question": "Which city had the most number of rides in winter 2013?", "sql": "SELECT pickup_city FROM uber WHERE pickup_datetime BETWEEN '2012-12-01' AND '2013-02-28' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city had the least passenger count of 2 in the given data?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 2 GROUP BY pickup_city ORDER BY COUNT(*) ASC LIMIT 1;"}
{"question": "Which city had the highest revenue in 2013?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2013' GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "What is the most common pickup hour in Brooklyn?", "sql": "SELECT strftime('%H', pickup_datetime) AS hour FROM uber WHERE pickup_city = 'Brooklyn' GROUP BY hour ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city had the fewest number of trips during weekdays?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY pickup_city ORDER BY COUNT(*) ASC LIMIT 1;"}
{"question": "Which city had the lowest total revenue across all years?", "sql": "SELECT pickup_city FROM uber GROUP BY pickup_city ORDER BY SUM(fare_amount) ASC LIMIT 1;"}
{"question": "In which city did trips with the highest average distance occur in 2012?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2012' GROUP BY pickup_city ORDER BY AVG(distance_miles) DESC LIMIT 1;"}
{"question": "Which city had the highest volume of rides between 6 PM and 8 PM across all years?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%H', pickup_datetime) BETWEEN '18' AND '20' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city were the most trips with exactly 3 passengers recorded during the spring months of 2013?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 3 AND pickup_datetime BETWEEN '2013-03-01' AND '2013-05-31' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city did trips that started and ended in the same city generate the most revenue in 2011?", "sql": "SELECT pickup_city FROM uber WHERE pickup_city = dropoff_city AND strftime('%Y', pickup_datetime) = '2011' GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "Which city generated the highest total revenue from trips in December across all years?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%m', pickup_datetime) = '12' GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "Which state had the highest total revenue from Uber trips in 2015?", "sql": "SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' GROUP BY pickup_statecode ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "In which state were the most trips with a fare amount greater than $50 recorded in 2014?", "sql": "SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2014' AND fare_amount > 50 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the lowest average trip distance in 2016?", "sql": "SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2016' GROUP BY pickup_statecode ORDER BY AVG(distance_miles) ASC LIMIT 1;"}
{"question": "Which state had the most rides between 6 PM and 8 PM in 2012?", "sql": "SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2012' AND strftime('%H', pickup_datetime) BETWEEN '18' AND '20' GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the least revenue from trips within the same state in 2012?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_statecode = dropoff_statecode AND strftime('%Y', pickup_datetime) = '2012' GROUP BY pickup_statecode ORDER BY SUM(fare_amount) ASC LIMIT 1;"}
{"question": "Which city has the most number of trips during weekends overall?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city has the highest average fare amount during weekends?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY pickup_city ORDER BY AVG(fare_amount) DESC LIMIT 1;"}
{"question": "Which city has the highest average passenger count during weekdays?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY pickup_city ORDER BY AVG(passenger_count) DESC LIMIT 1;"}
{"question": "Which city has the lowest average fare amount during weekdays?", "sql": "SELECT pickup_city FROM uber WHERE strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY pickup_city ORDER BY AVG(fare_amount) ASC LIMIT 1;"}
{"question": "What is the highest average passenger count in New York during weekdays?", "sql": "SELECT AVG(passenger_count) FROM uber WHERE pickup_city = 'New York' AND strftime('%w', pickup_datetime) NOT IN ('0', '6');"}
{"question": "What is the most common passenger count in New York during weekdays?", "sql": "SELECT passenger_count FROM uber WHERE pickup_city = 'New York' AND strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY passenger_count ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"Which city had the most trips with a fare amount over $100 during the summer of 2017?","sql":"SELECT pickup_city FROM uber WHERE fare_amount > 100 AND pickup_datetime BETWEEN '2017-06-01' AND '2017-08-31' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"In which city were the most trips with exactly 2 passengers recorded during the winter months of 2016?","sql":"SELECT pickup_city FROM uber WHERE passenger_count = 2 AND pickup_datetime BETWEEN '2016-12-01' AND '2016-02-28' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"Which state had the highest total revenue from Uber trips during the fall of 2019?","sql":"SELECT pickup_statecode FROM uber WHERE pickup_datetime BETWEEN '2019-09-01' AND '2019-11-30' GROUP BY pickup_statecode ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question":"Which city had the lowest average fare amount in 2018?","sql":"SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2018' GROUP BY pickup_city ORDER BY AVG(fare_amount) ASC LIMIT 1;"}
{"question":"Which state had the most trips with more than 4 passengers in 2019?","sql":"SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2019' AND passenger_count > 4 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"Which city had the highest revenue from trips on Fridays in 2015?","sql":"SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' AND strftime('%w', pickup_datetime) = '5' GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question":"In which state were the most rides recorded between midnight and 3 AM in 2018?","sql":"SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2018' AND strftime('%H', pickup_datetime) BETWEEN '00' AND '03' GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"Which city had the highest average trip distance in 2014?","sql":"SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2014' GROUP BY pickup_city ORDER BY AVG(distance_miles) DESC LIMIT 1;"}
{"question":"Which state had the most trips with a fare amount under $10 in 2013?","sql":"SELECT pickup_statecode FROM uber WHERE strftime('%Y', pickup_datetime) = '2013' AND fare_amount < 10 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question":"Which city had the lowest average passenger count during weekdays in 2017?","sql":"SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2017' AND strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY pickup_city ORDER BY AVG(passenger_count) ASC LIMIT 1;"}
{"question":"What was the highest total revenue from trips in San Francisco in 2016?","sql":"SELECT SUM(fare_amount) FROM uber WHERE pickup_city = 'San Francisco' AND strftime('%Y', pickup_datetime) = '2016';"}
{"question":"Which city had the highest average fare amount during weekends in 2015?","sql":"SELECT pickup_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' AND strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY pickup_city ORDER BY AVG(fare_amount) DESC LIMIT 1;"}
{"question": "How many trips were recorded in 2010?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2010';"}
{"question": "How many trips were recorded in 2010?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE pickup_datetime BETWEEN '2010-01-01 00:00:00' AND '2010-12-31 23:59:59';"}
{"question": "Was there any trip recorded on December 25th, 2014?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE strftime('%Y-%m-%d', pickup_datetime) = '2014-12-25';"}
{"question": "Was there any trip recorded on December 25th, 2014?", "sql": "SELECT COUNT(*) AS trip_count FROM uber WHERE pickup_datetime LIKE '%2014-12-25%';"}
{"question": "What is the total revenue generated in 2014?", "sql": "SELECT SUM(fare_amount) AS total_revenue FROM uber WHERE pickup_datetime BETWEEN '2014-01-01 00:00:00' AND '2014-12-31 23:59:59';"}
{"question": "Which city had the highest number of drop-offs in 2015?", "sql": "SELECT dropoff_city FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' GROUP BY dropoff_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city had the highest number of drop-offs in 2015?", "sql": "SELECT dropoff_city FROM uber WHERE pickup_datetime BETWEEN '2015-01-01 00:00:00' AND '2015-12-31 23:59:59' GROUP BY dropoff_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which city had the least passenger count of 2 in the given data?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 2 GROUP BY pickup_city ORDER BY COUNT(*) ASC LIMIT 1;"}
{"question": "What is the most common pickup hour in Brooklyn?", "sql": "SELECT hour FROM (SELECT strftime('%H', pickup_datetime) AS hour FROM uber WHERE pickup_city = 'Brooklyn' GROUP BY hour ORDER BY COUNT(*) DESC) AS subquery LIMIT 1;"}
{"question": "What is the most common pickup hour in Brooklyn?", "sql": "SELECT strftime('%H', pickup_datetime) AS hour FROM uber WHERE pickup_city = 'Brooklyn' GROUP BY hour ORDER BY COUNT(*) DESC LIMIT 1 OFFSET 0;"}
{"question": "Which city had the fewest number of trips during weekdays?", "sql": "SELECT pickup_city FROM uber WHERE pickup_datetime NOT LIKE '%weekend%' GROUP BY pickup_city ORDER BY COUNT(*) ASC LIMIT 1;"}
{"question": "Which city had the fewest number of trips during weekdays?", "sql": "SELECT pickup_city FROM uber WHERE pickup_datetime NOT LIKE '%saturday%' AND pickup_datetime NOT LIKE '%sunday%' GROUP BY pickup_city ORDER BY COUNT(*) ASC LIMIT 1;"}
{"question": "In which city did trips with the highest average distance occur in 2012?", "sql": "SELECT pickup_city FROM uber WHERE pickup_datetime BETWEEN '2012-01-01 00:00:00' AND '2012-12-31 23:59:59' GROUP BY pickup_city ORDER BY AVG(distance_miles) DESC LIMIT 1;"}
{"question": "Which city had the highest volume of rides between 6 PM and 8 PM across all years?", "sql": "SELECT pickup_city FROM uber WHERE pickup_datetime BETWEEN '18:00:00' AND '20:00:00' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city were the most trips with exactly 3 passengers recorded during the spring months of 2013?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 3 AND pickup_datetime >= '2013-03-01' AND pickup_datetime <= '2013-05-31' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city did trips that started and ended in the same city generate the most revenue in 2011?", "sql": "SELECT pickup_city FROM uber WHERE pickup_city = dropoff_city AND pickup_datetime BETWEEN '2011-01-01 00:00:00' AND '2011-12-31 23:59:59' GROUP BY pickup_city ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "Which state had the highest total revenue from Uber trips in 2015?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime >= '2015-01-01' AND pickup_datetime <= '2015-12-31' GROUP BY pickup_statecode ORDER BY SUM(fare_amount) DESC LIMIT 1;"}
{"question": "In which state were the most trips with a fare amount greater than $50 recorded in 2014?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime LIKE '2014%' AND fare_amount > 50 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which state were the most trips with a fare amount greater than $50 recorded in 2014?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime >= '2014-01-01' AND pickup_datetime < '2015-01-01' AND fare_amount > 50 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the most rides between 6 PM and 8 PM in 2012?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime BETWEEN '2012-06-01 18:00:00' AND '2012-06-01 20:00:00' GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the least revenue from trips within the same state in 2012?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_statecode = dropoff_statecode AND pickup_datetime BETWEEN '2012-01-01 00:00:00' AND '2012-12-31 23:59:59' GROUP BY pickup_statecode ORDER BY SUM(fare_amount) ASC LIMIT 1;"}
{"question": "Which city has the highest average passenger count during weekdays?", "sql": "SELECT pickup_city FROM (SELECT pickup_city, AVG(passenger_count) AS avg_passenger_count FROM uber WHERE strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY pickup_city ORDER BY avg_passenger_count DESC) AS subquery LIMIT 1;"}
{"question": "What is the most common passenger count in New York during weekdays?", "sql": "SELECT passenger_count FROM uber WHERE pickup_city = 'New York' AND strftime('%w', pickup_datetime) NOT IN ('0', '6') GROUP BY passenger_count ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "What is the most common passenger count in New York during weekdays?", "sql": "SELECT passenger_count FROM uber WHERE pickup_city = 'New York' AND pickup_datetime NOT IN (SELECT pickup_datetime FROM uber WHERE strftime('%w', pickup_datetime) IN ('0', '6')) GROUP BY passenger_count ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city were the most trips with exactly 2 passengers recorded during the winter months of 2016?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 2 AND pickup_datetime BETWEEN '2016-01-01' AND '2016-02-28' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which city were the most trips with exactly 2 passengers recorded during the winter months of 2016?", "sql": "SELECT pickup_city FROM uber WHERE passenger_count = 2 AND pickup_datetime >= '2016-12-01' AND pickup_datetime <= '2016-02-28' GROUP BY pickup_city ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the highest total revenue from Uber trips during the fall of 2019?", "sql": "SELECT pickup_statecode FROM (SELECT pickup_statecode, SUM(fare_amount) AS total_revenue FROM uber WHERE pickup_datetime BETWEEN '2019-09-01' AND '2019-11-30' GROUP BY pickup_statecode) AS subquery ORDER BY total_revenue DESC LIMIT 1;"}
{"question": "Which city had the lowest average fare amount in 2018?", "sql": "SELECT pickup_city FROM (SELECT pickup_city, AVG(fare_amount) AS avg_fare FROM uber WHERE strftime('%Y', pickup_datetime) = '2018' GROUP BY pickup_city) AS subquery ORDER BY avg_fare ASC LIMIT 1;"}
{"question": "Which state had the most trips with more than 4 passengers in 2019?", "sql": "SELECT pickup_statecode FROM uber WHERE passenger_count > 4 AND strftime('%Y', pickup_datetime) = '2019' GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "In which state were the most rides recorded between midnight and 3 AM in 2018?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime BETWEEN '2018-01-01 00:00:00' AND '2018-01-03 03:59:59' GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the most trips with a fare amount under $10 in 2013?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime LIKE '2013%' AND fare_amount < 10 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "Which state had the most trips with a fare amount under $10 in 2013?", "sql": "SELECT pickup_statecode FROM uber WHERE pickup_datetime >= '2013-01-01' AND pickup_datetime < '2014-01-01' AND fare_amount < 10 GROUP BY pickup_statecode ORDER BY COUNT(*) DESC LIMIT 1;"}
{"question": "What was the highest total revenue from trips in San Francisco in 2016?", "sql": "SELECT SUM(fare_amount) FROM uber WHERE pickup_city = 'San Francisco' AND pickup_datetime BETWEEN '2016-01-01 00:00:00' AND '2016-12-31 23:59:59';"}
{"question": "Which three cities had the highest total fare amount in 2014?","sql": "SELECT pickup_city, SUM(fare_amount) AS total_fare_amount FROM uber WHERE strftime('%Y', pickup_datetime) = '2014' GROUP BY pickup_city ORDER BY total_fare_amount DESC LIMIT 3;"}
{"question": "What are the top three counties in New York with the highest average fare amount per trip in 2015?","sql": "SELECT pickup_county, AVG(fare_amount) AS average_fare_amount FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' AND pickup_statecode = 'NY' GROUP BY pickup_county ORDER BY average_fare_amount DESC LIMIT 3;"}
{"question": "Which three cities had the highest number of trips with more than 5 passengers in 2012?","sql": "SELECT pickup_city, COUNT(*) AS trip_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2012' AND passenger_count > 5 GROUP BY pickup_city ORDER BY trip_count DESC LIMIT 3;"}
{"question": "What are the top three states with the highest total distance traveled in 2015?","sql": "SELECT pickup_statecode, SUM(distance_miles) AS total_distance_miles FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' GROUP BY pickup_statecode ORDER BY total_distance_miles DESC LIMIT 3;"}
{"question": "Which three cities saw the largest increase in average fare amount from 2013 to 2014?","sql": "WITH fare_amount_by_year AS (SELECT pickup_city, SUM(CASE WHEN strftime('%Y', pickup_datetime) = '2013' THEN fare_amount ELSE 0 END) AS fare_amount_2013, SUM(CASE WHEN strftime('%Y', pickup_datetime) = '2014' THEN fare_amount ELSE 0 END) AS fare_amount_2014 FROM uber GROUP BY pickup_city) SELECT pickup_city, (fare_amount_2014 - fare_amount_2013) AS fare_amount_increase FROM fare_amount_by_year WHERE fare_amount_2014 > fare_amount_2013 ORDER BY fare_amount_increase DESC LIMIT 3;"}
{"question": "What are the top three counties with the highest total revenue from trips in 2011?","sql": "SELECT pickup_county, SUM(fare_amount) AS total_revenue FROM uber WHERE strftime('%Y', pickup_datetime) = '2011' GROUP BY pickup_county ORDER BY total_revenue DESC LIMIT 3;"}
{"question": "Which city had the highest number of trips during peak hours 4 PM to 8 PM in 2015?","sql": "SELECT pickup_city, COUNT(*) AS trip_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' AND strftime('%H', pickup_datetime) BETWEEN '16' AND '20' GROUP BY pickup_city ORDER BY trip_count DESC LIMIT 3;"}
{"question": "What are the top three cities in New York with the highest average passenger count per trip in 2010?","sql": "WITH average_passenger_count AS (SELECT pickup_city, AVG(passenger_count) AS average_passenger_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2010' AND pickup_statecode = 'NY' GROUP BY pickup_city) SELECT pickup_city, average_passenger_count FROM average_passenger_count ORDER BY average_passenger_count DESC LIMIT 3;"}
{"question": "Which three states had the highest number of rides with a fare amount above $50 in 2013?","sql": "SELECT pickup_statecode, COUNT(*) AS ride_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2013' AND fare_amount > 50 GROUP BY pickup_statecode ORDER BY ride_count DESC LIMIT 3;"}
{"question": "What are the top three cities with the lowest average fare amount per trip in 2011?","sql": "WITH average_fare_amount AS (SELECT pickup_city, AVG(fare_amount) AS average_fare_amount FROM uber WHERE strftime('%Y', pickup_datetime) = '2011' GROUP BY pickup_city) SELECT pickup_city, average_fare_amount FROM average_fare_amount ORDER BY average_fare_amount ASC LIMIT 3;"}
{"question": "What are the top three cities with the highest number of rides during weekends in 2014?","sql": "SELECT pickup_city, COUNT(*) AS ride_count FROM uber WHERE strftime('%Y', pickup_datetime) = '2014' AND strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY pickup_city ORDER BY ride_count DESC LIMIT 3;"}
{"question": "Which three counties experienced the highest drop in total distance traveled from 2012 to 2013?","sql": "WITH distance_by_year AS (SELECT pickup_county, SUM(CASE WHEN strftime('%Y', pickup_datetime) = '2012' THEN distance_miles ELSE 0 END) AS distance_2012, SUM(CASE WHEN strftime('%Y', pickup_datetime) = '2013' THEN distance_miles ELSE 0 END) AS distance_2013 FROM uber GROUP BY pickup_county) SELECT pickup_county, (distance_2012 - distance_2013) AS distance_drop FROM distance_by_year WHERE distance_2012 > distance_2013 ORDER BY distance_drop DESC LIMIT 3;"}
{"question": "Which three cities had the highest revenue from trips with a distance greater than 15 miles in 2015?","sql": "SELECT pickup_city, SUM(fare_amount) AS total_revenue FROM uber WHERE strftime('%Y', pickup_datetime) = '2015' AND distance_miles > 15 GROUP BY pickup_city ORDER BY total_revenue DESC LIMIT 3;"}
{"question": "What is the increase in average fare collected for trips with exactly one passenger in New York from 2012 to 2013?","sql":"WITH average_fare_by_year AS (SELECT strftime('%Y', pickup_datetime) AS year, AVG(fare_amount) AS average_fare FROM uber WHERE passenger_count = 1 AND strftime('%Y', pickup_datetime) IN ('2012', '2013') AND pickup_statecode = 'NY' GROUP BY year) SELECT (SELECT average_fare FROM average_fare_by_year WHERE year = '2013') - (SELECT average_fare FROM average_fare_by_year WHERE year = '2012') AS fare_increase;"}
{"question": "What is the most popular pickup day of the week in New York?","sql": "SELECT strftime('%w', pickup_datetime) AS day_of_week, COUNT(*) AS pickup_count FROM uber WHERE pickup_statecode = 'NY' GROUP BY day_of_week ORDER BY pickup_count DESC LIMIT 1;"}
{"question": "What is the most popular pickup month in New York?","sql": "SELECT strftime('%m', pickup_datetime) AS month, COUNT(*) AS pickup_count FROM uber WHERE pickup_statecode = 'NY' GROUP BY month ORDER BY pickup_count DESC LIMIT 1;"}
{"question": "What is the most popular pickup hour on weekends in New York?","sql": "SELECT strftime('%H', pickup_datetime) AS hour, COUNT(*) AS pickup_count FROM uber WHERE pickup_statecode = 'NY' AND strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY hour ORDER BY pickup_count DESC LIMIT 1;"}
{"question": "What is the most popular pickup time during weekdays in New York?","sql": "SELECT strftime('%H:%M', pickup_datetime) AS time, COUNT(*) AS pickup_count FROM uber WHERE pickup_statecode = 'NY' AND strftime('%w', pickup_datetime) BETWEEN '1' AND '5' GROUP BY time ORDER BY pickup_count DESC LIMIT 1;"}
{"question": "Which city in New York has the highest number of rides with exactly one passenger on weekends?","sql": "SELECT pickup_city, COUNT(*) AS ride_count FROM uber WHERE pickup_statecode = 'NY' AND passenger_count = 1 AND strftime('%w', pickup_datetime) IN ('0', '6') GROUP BY pickup_city ORDER BY ride_count DESC LIMIT 1;"}
{"question": "Which city in New York experienced the highest increase in the number of trips during the winter holidays (December) from 2011 to 2012?","sql": "SELECT pickup_city, (COUNT(CASE WHEN strftime('%Y', pickup_datetime) = '2012' THEN 1 END) - COUNT(CASE WHEN strftime('%Y', pickup_datetime) = '2011' THEN 1 END)) AS increase_in_trips FROM uber WHERE pickup_statecode = 'NY' AND strftime('%m', pickup_datetime) = '12' GROUP BY pickup_city ORDER BY increase_in_trips DESC LIMIT 1;"}