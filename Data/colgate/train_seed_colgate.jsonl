{"question": "How is Colgate's unit SOM performance?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer LIKE 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE market_desc = 'Total US xAOC';"}
{"question": "How is Colgate's share of market performance in terms of unit sales YTD?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer LIKE 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "How is Colgate's unit SOM performance YTD in Target?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer LIKE 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Target Total BM/FF TA';"}
{"question": "How is the manufacturer Colgate's sales volume SOM performance?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS total_volume_colgate, SUM(sales_volume) AS total_volume_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS colgate_volume_share FROM colgate WHERE market_desc = 'Total US xAOC';"}
{"question": "How is Colgate's total sales and total sales volume SOM performance YTD", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) AS total_value_colgate, SUM(sales_value) AS total_value_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) * 100.0) / SUM(sales_value) AS colgate_value_share, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS total_volume_colgate, SUM(sales_volume) AS total_volume_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS colgate_volume_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "How is Colgate's unit SOM performance YTD grouped by market?", "sql": "SELECT market_desc, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer LIKE 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What are total sales for each brand in manufacturer P&G?", "sql": "SELECT brand, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'P&G' AND market_desc = 'Total US xAOC' GROUP BY brand;"}
{"question": "What are total sales for each brand in manufacturer Colgate?", "sql": "SELECT brand, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'COLGATE' AND market_desc = 'Total US xAOC' GROUP BY brand;"}
{"question": "What are the total sales and total units sold for Crest 3d white brand in Target?", "sql": "SELECT SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Target Total BM/FF TA';"}
{"question": "What are the total sales and total units sold for COLGATE MAX FRANCHISE brand in Family Dollar?", "sql": "SELECT SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'COLGATE MAX FRANCHISE' AND market_desc = 'Family Dollar Total TA';"}
{"question": "What are the total sales and total units sold for Crest 3d white brand?", "sql": "SELECT SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC';"}
{"question": "What are SKU sales for each market?", "sql": "SELECT market_desc, item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, item, long_desc;"}
{"question": "What are SKU sales for all items?", "sql": "SELECT item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY item, long_desc;"}
{"question": "What are SKU sales for all items in Target?", "sql": "SELECT item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Target Total BM/FF TA' GROUP BY item, long_desc;"}
{"question": "What are SKU sales for all items in Family Dollar?", "sql": "SELECT item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate WHERE LOWER(market_desc) LIKE '%family dollar total%' GROUP BY item, long_desc;"}
{"question": "What are SKU sales for all items in ShopRite?", "sql": "SELECT item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate WHERE LOWER(market_desc) LIKE '%shoprite%' GROUP BY item, long_desc;"}
{"question": "What are SKU sales for all items in Colgate franchise?", "sql": "SELECT item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' AND franchise = 'COLGATE' GROUP BY item, long_desc;"}
{"question": "What are total sales for each product variant in each market?", "sql": "SELECT market_desc, variant, SUM(sales_value) AS total_sales FROM colgate GROUP BY market_desc, variant;"}
{"question": "What are total sales for each product variant in the Colgate franchise in ShopRite?", "sql": "SELECT variant, SUM(sales_value) AS total_sales FROM colgate WHERE market_desc = 'ShopRite Total TA' AND franchise = 'COLGATE' GROUP BY variant;"}
{"question": "What are total sales for each product variant in Crest franchise in Target?", "sql": "SELECT variant, SUM(sales_value) AS total_sales FROM colgate WHERE market_desc = 'Target Total BM/FF TA' AND franchise = 'CREST' GROUP BY variant;"}
{"question": "What are total sales for each product variant in Target?", "sql": "SELECT variant, SUM(sales_value) AS total_sales FROM colgate WHERE market_desc = 'Target Total BM/FF TA' GROUP BY variant;"}
{"question": "What are total units sold in each market?", "sql": "SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc;"}
{"question": "For each segment and year, what are the total unit sales, value share and sales volume?", "sql": "SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value;"}
{"question": "Which brand has the highest overall total revenue?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY brand ORDER BY SUM(sales_value) DESC LIMIT 1;"}
{"question": "Which brand has the lowest overall total revenue?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY brand ORDER BY SUM(sales_value) ASC LIMIT 1;"}
{"question": "Which market has the highest total sales value?", "sql": "SELECT market_desc FROM colgate GROUP BY market_desc ORDER BY SUM(sales_value) DESC LIMIT 1;"}
{"question": "Which segment has the highest total revenue?", "sql": "SELECT segment FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment ORDER BY SUM(sales_value) DESC LIMIT 1;"}
{"question": "Which brand has the highest total sales volume?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY brand ORDER BY SUM(sales_volume) DESC LIMIT 1;"}
{"question": "Which brand has the lowest total sales volume?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY brand ORDER BY SUM(sales_volume) ASC LIMIT 1;"}
{"question": "Which brand has the highest sales volume under the Colgate franchise?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' AND franchise = 'COLGATE' GROUP BY brand ORDER BY SUM(sales_volume) DESC LIMIT 1;"}
{"question": "Which brand has the lowest sales volume under the Colgate franchise?", "sql": "SELECT brand FROM colgate WHERE market_desc = 'Total US xAOC' AND franchise = 'COLGATE' GROUP BY brand ORDER BY SUM(sales_volume) ASC LIMIT 1;"}
{"question": "Which Colgate size has the highest sales volume for the brand 'COLGATE MAX FRANCHISE'?", "sql": "SELECT colgate_size FROM colgate WHERE market_desc = 'Total US xAOC' AND brand = 'COLGATE MAX FRANCHISE' GROUP BY colgate_size ORDER BY SUM(sales_volume) DESC LIMIT 1;"}
{"question": "Which brands had the highest total promotional sales value in Family Dollar?", "sql": "SELECT brand, SUM(promo_sales_value) AS total_promo_sales_value FROM colgate WHERE LOWER(market_desc) LIKE '%family dollar%' GROUP BY brand ORDER BY total_promo_sales_value DESC;"}
{"question": "Which brands had the highest total promotional sales value in Target?", "sql": "SELECT brand, SUM(promo_sales_value) AS total_promo_sales_value FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_value DESC;"}
{"question": "Which brands had the highest total promotional sales units in Target?", "sql": "SELECT brand, SUM(promo_sales_units) AS total_promo_sales_units FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_units DESC;"}
{"question": "Which brands had the highest total promotional sales volume in Target?", "sql": "SELECT brand, SUM(promo_sales_volume) AS total_promo_sales_volume FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_volume DESC;"}
{"question": "Which brands had the lowest total promotional sales value in Target?", "sql": "SELECT brand, SUM(promo_sales_value) AS total_promo_sales_value FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_value ASC;"}
{"question": "Which brands had the lowest total promotional sales units in Target?", "sql": "SELECT brand, SUM(promo_sales_units) AS total_promo_sales_units FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_units ASC;"}
{"question": "Which brands had the lowest total promotional sales volume in Target?", "sql": "SELECT brand, SUM(promo_sales_volume) AS total_promo_sales_volume FROM colgate WHERE LOWER(market_desc) LIKE '%target%' GROUP BY brand ORDER BY total_promo_sales_volume ASC;"}
{"question": "Which products from Crest franchise were on promo in Family Dollar in March 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise were on promo in Target in March 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise were on promo in ShopRite in March 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%shoprite%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise were on promo in Family Dollar in October 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 10 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise were on promo in Target in June 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 6 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise were on promo in Family Dollar in December 2024? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 12 GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which Colgate brand had the highest total sales value in the Family Dollar Total market, and what is the sales value?", "sql": "SELECT brand, SUM(sales_value) AS total_sales_value FROM colgate WHERE LOWER(market_desc) LIKE '%family dollar total%' AND LOWER(franchise) LIKE '%colgate%' GROUP BY brand ORDER BY total_sales_value DESC LIMIT 1;"}
{"question": "Which products from Crest franchise that were on promo in Family Dollar in March 2024 are multi-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 AND multi_pack = 'MULTI' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise that were on promo in Family Dollar in March 2024 are single-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 AND multi_pack = 'SINGLE' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise that were on promo in Family Dollar in March 2024 are banded packs? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 3 AND multi_pack = 'BANDED' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise that were on promo in Target in September 2024 are multi-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 9 AND multi_pack = 'MULTI' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise that were on promo in Target in October 2024 are single-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 10 AND multi_pack = 'SINGLE' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Crest franchise that were on promo in Target in December 2024 are banded packs? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 12 AND multi_pack = 'BANDED' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise that were on promo in Family Dollar in June 2024 are multi-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%family dollar%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 6 AND multi_pack = 'MULTI' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise that were on promo in Target in June 2024 are single-pack? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 6 AND multi_pack = 'SINGLE' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "Which products from Colgate franchise that were on promo in Target in June 2024 are banded packs? Include item and long description for each item.", "sql": "SELECT distinct item, long_desc FROM colgate WHERE franchise = 'COLGATE' AND year_value = '2024' AND LOWER(market_desc) LIKE '%target%' AND promo_sales_units > 0 AND CAST(strftime('%m', month_445) AS INTEGER) = 6 AND multi_pack = 'BANDED' GROUP BY item, long_desc ORDER BY item, long_desc;"}
{"question": "How is each manufacturer doing YOY in terms of sales value with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) AS total_sales_value_2024, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) AS yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing YOY in terms of sales volume with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) AS total_sales_volume_2024, SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END) AS total_sales_volume_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) AS yoy_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing YOY in terms of units sold with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_units ELSE 0 END) AS total_sales_units_2024, SUM(CASE WHEN year_value = 2023 THEN sales_units ELSE 0 END) AS total_sales_units_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_units ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_units ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_units ELSE 0 END)) AS yoy_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q1 YOY in terms of sales value with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) AS total_sales_value_2024, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) AS q1_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 1 AND 3 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q2 YOY in terms of sales value with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) AS total_sales_value_2024, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) AS q2_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q3 YOY in terms of sales value with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) AS total_sales_value_2024, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) AS q3_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 7 AND 9 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q4 YOY in terms of sales value with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) AS total_sales_value_2024, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END)) AS q4_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 10 AND 12 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q1 YOY in terms of sales volume with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) AS total_sales_volume_2024, SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END) AS total_sales_volume_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) AS q1_yoy_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 1 AND 3 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q2 YOY in terms of sales volume with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) AS total_sales_volume_2024, SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END) AS total_sales_volume_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) AS q2_yoy_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q3 YOY in terms of sales volume with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) AS total_sales_volume_2024, SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END) AS total_sales_volume_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) AS q3_yoy_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 7 AND 9 GROUP BY manufacturer;"}
{"question": "How is each manufacturer doing Q4 YOY in terms of sales volume with the current year being 2024?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) AS total_sales_volume_2024, SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END) AS total_sales_volume_2023, ROUND((SUM(CASE WHEN year_value = 2024 THEN sales_volume ELSE 0 END) - SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2023 THEN sales_volume ELSE 0 END)) AS q4_yoy_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 10 AND 12 GROUP BY manufacturer;"}
{"question": "What is each manufacturer's performance in Q1 YOY in terms of sales value with the current year being 2023?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) AS total_sales_value_2022, ROUND((SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END)) AS q1_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 1 AND 3 GROUP BY manufacturer;"}
{"question": "What is each manufacturer's performance in Q2 YOY in terms of sales value with the current year being 2022?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) AS total_sales_value_2022, SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END) AS total_sales_value_2021, ROUND((SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END)) AS q2_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer;"}
{"question": "What is each manufacturer's performance in Q3 YOY in terms of sales value with the current year being 2022?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) AS total_sales_value_2022, SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END) AS total_sales_value_2021, ROUND((SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2021 THEN sales_value ELSE 0 END)) AS q3_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 7 AND 9 GROUP BY manufacturer;"}
{"question": "What is each manufacturer's performance in Q4 YOY in terms of sales value with the current year being 2023?", "sql": "SELECT manufacturer, SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) AS total_sales_value_2023, SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END) AS total_sales_value_2022, ROUND((SUM(CASE WHEN year_value = 2023 THEN sales_value ELSE 0 END) - SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END)) * 100.0 / SUM(CASE WHEN year_value = 2022 THEN sales_value ELSE 0 END)) AS q4_yoy_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 10 AND 12 GROUP BY manufacturer;"}
{"question": "What is the sales velocity of optic white products in Family Dollar for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH optic_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'Family Dollar Total TA' and year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM optic_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of optic white products in Target for 2023? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH optic_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'Target Total BM/FF TA' and year_value = 2023 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM optic_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of Crest 3d white products for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH crest_3d_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' and year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM crest_3d_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of optic white products for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH optic_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'ShopRite Total TA' and year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM optic_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of Crest 3d white products for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH crest_3d_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' and year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM crest_3d_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of Crest 3d white products for 2023? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH crest_3d_white_prods AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' and year_value = 2023 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM crest_3d_white_prods) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of products from Colgate franchise in ShopRite for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH colgate_franchise_prods AS (SELECT year_value, item, market_desc, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE franchise = 'COLGATE' AND market_desc = 'ShopRite Total TA' and year_value = 2024 GROUP BY year_value, item, market_desc, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM colgate_franchise_prods) SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of products from Colgate franchise in Target for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH colgate_franchise_prods AS (SELECT year_value, item, market_desc, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE franchise = 'COLGATE' AND market_desc = 'Target Total BM/FF TA' and year_value = 2024 GROUP BY year_value, item, market_desc, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM colgate_franchise_prods) SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "What is the sales velocity of products from Colgate franchise for 2024? Sales velocity is defined as sum of sales value divided by sum of All Commodity Volume. Show each item as a separate row, include sales velocity as a column and sort in descending order of sales velocity.", "sql": "WITH colgate_franchise_prods AS (SELECT year_value, item, market_desc, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE franchise = 'COLGATE' AND market_desc = 'Total US xAOC' and year_value = 2024 GROUP BY year_value, item, market_desc, long_desc), sales_velocity_calculation AS (SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value / tdp END AS sales_velocity FROM colgate_franchise_prods) SELECT year_value, item, market_desc, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "Basic filter for current year to date", "sql": "SELECT * FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What are the total units sold for Colgate?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What are the total units sold for all manufacturers?", "sql": "SELECT SUM(sales_units) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's unit SOM (Share of Market) YTD?", "sql": "WITH colgate_units AS (SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS units FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), all_units AS (SELECT SUM(sales_units) AS units FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT (colgate_units.units * 100.0) / all_units.units AS colgate_unit_share FROM colgate_units, all_units;"}
{"question": "What is Colgate's unit SOM by month?", "sql": "SELECT strftime('%m', month_445) AS month, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY month ORDER BY month;"}
{"question": "What are the top 5 Colgate products by unit sales?", "sql": "SELECT brand, subbrand, SUM(sales_units) AS total_units FROM colgate WHERE manufacturer = 'COLGATE' AND year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY brand, subbrand ORDER BY total_units DESC LIMIT 5;"}
{"question": "What is Colgate's unit SOM for different product forms?", "sql": "SELECT product_form, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY product_form;"}
{"question": "What is Colgate's unit SOM for different price tiers?", "sql": "SELECT price_tier, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY price_tier;"}
{"question": "Compare Colgate's promotional vs. non-promotional unit sales", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN promo_sales_units ELSE 0 END) AS promo_units, SUM(CASE WHEN manufacturer = 'COLGATE' THEN no_promo_sales_units ELSE 0 END) AS non_promo_units, SUM(CASE WHEN manufacturer = 'COLGATE' THEN promo_sales_units ELSE 0 END) * 100.0 / SUM(CASE WHEN manufacturer = 'COLGATE' THEN (promo_sales_units + no_promo_sales_units) ELSE 0 END) AS promo_percentage FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's total units and unit share?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's total value and value share?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) AS total_value_colgate, SUM(sales_value) AS total_value_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) * 100.0) / SUM(sales_value) AS colgate_value_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's total volume and volume share?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS total_volume_colgate, SUM(sales_volume) AS total_volume_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS colgate_volume_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "Compare of Colgate's unit, value, and volume shares", "sql": "WITH unit_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), value_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) * 100.0) / SUM(sales_value) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), volume_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT unit_share.share AS unit_share, value_share.share AS value_share, volume_share.share AS volume_share FROM unit_share, value_share, volume_share;"}
{"question": "How does Colgate's unit SOM performance compare to unit and value share?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) AS total_value_colgate, SUM(sales_value) AS total_value_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) * 100.0) / SUM(sales_value) AS colgate_value_share, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS total_volume_colgate, SUM(sales_volume) AS total_volume_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS colgate_volume_share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "Find Colgate's total units", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "Find the total units for all manufacturers", "sql": "SELECT SUM(sales_units) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "Find Colgate's unit share", "sql": "WITH colgate_units AS (SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS units FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), all_units AS (SELECT SUM(sales_units) AS units FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT (colgate_units.units * 100.0) / all_units.units AS colgate_unit_share FROM colgate_units, all_units;"}
{"question": "What is Colgate's total value?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) AS total_value_colgate FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is the total value for all manufacturers?", "sql": "SELECT SUM(sales_value) AS total_value_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's value share?", "sql": "WITH colgate_value AS (SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) AS value FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), all_value AS (SELECT SUM(sales_value) AS value FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT (colgate_value.value * 100.0) / all_value.value AS colgate_value_share FROM colgate_value, all_value;"}
{"question": "What is Colgate's total volume?", "sql": "SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS total_volume_colgate FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "Find the total volume for all manufacturers", "sql": "SELECT SUM(sales_volume) AS total_volume_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC';"}
{"question": "What is Colgate's volume share?", "sql": "WITH colgate_volume AS (SELECT SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) AS volume FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), all_volume AS (SELECT SUM(sales_volume) AS volume FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT (colgate_volume.volume * 100.0) / all_volume.volume AS colgate_volume_share FROM colgate_volume, all_volume;"}
{"question": "Compare of Colgate's unit, value, and volume shares", "sql": "WITH unit_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), value_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_value ELSE 0 END) * 100.0) / SUM(sales_value) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC'), volume_share AS (SELECT (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_volume ELSE 0 END) * 100.0) / SUM(sales_volume) AS share FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC') SELECT unit_share.share AS unit_share, value_share.share AS value_share, volume_share.share AS volume_share FROM unit_share, value_share, volume_share;"}
{"question": "List the unique retailers (market_desc)", "sql": "SELECT DISTINCT market_desc FROM colgate WHERE year_value = strftime('%Y', 'now') ORDER BY market_desc;"}
{"question": "List Colgate's total units by retailer", "sql": "SELECT market_desc, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate FROM colgate WHERE year_value = strftime('%Y', 'now') GROUP BY market_desc ORDER BY market_desc;"}
{"question": "What are the total units for all manufacturers by retailer?", "sql": "SELECT market_desc, SUM(sales_units) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') GROUP BY market_desc ORDER BY market_desc;"}
{"question": "What is Colgate's unit share by retailer?", "sql": "SELECT market_desc, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') GROUP BY market_desc ORDER BY colgate_unit_share DESC;"}
{"question": "What is Colgate's unit share by retailer with total units?", "sql": "SELECT market_desc, SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) AS total_units_colgate, SUM(sales_units) AS total_units_all, (SUM(CASE WHEN manufacturer = 'COLGATE' THEN sales_units ELSE 0 END) * 100.0) / SUM(sales_units) AS colgate_unit_share FROM colgate WHERE year_value = strftime('%Y', 'now') GROUP BY market_desc ORDER BY colgate_unit_share DESC;"}
{"question": "Filter Q2 data", "sql": "SELECT * FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6;"}
{"question": "What was the total sales value for each manufacturer in Q2 (for all years)?", "sql": "SELECT manufacturer, year_value, SUM(sales_value) AS total_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer, year_value ORDER BY manufacturer, year_value;"}
{"question": "What is the CTE for Q2 sales?", "sql": "WITH sales_q2 AS ( SELECT manufacturer, year_value, SUM(sales_value) AS total_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer, year_value ) SELECT * FROM sales_q2 ORDER BY manufacturer, year_value;"}
{"question": "What is the YOY comparison for a 2024?", "sql": "WITH sales_q2 AS ( SELECT manufacturer, year_value, SUM(sales_value) AS total_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer, year_value ) SELECT s1.manufacturer, s1.year_value AS current_year, s1.total_sales_value AS current_sales, s2.total_sales_value AS previous_sales, ((s1.total_sales_value - s2.total_sales_value) / s2.total_sales_value) * 100 AS yoy_change FROM sales_q2 s1 JOIN sales_q2 s2 ON s1.manufacturer = s2.manufacturer AND s1.year_value = s2.year_value + 1 WHERE s1.year_value = 2024 ORDER BY yoy_change DESC;"}
{"question": "How is each manufacturer doing in Q2 YOY in terms of value?", "sql": "WITH sales_q2 AS ( SELECT manufacturer, year_value, SUM(sales_value) AS total_sales_value FROM colgate WHERE market_desc = 'Total US xAOC' AND CAST(strftime('%m', month_445) AS INTEGER) BETWEEN 4 AND 6 GROUP BY manufacturer, year_value ), sales_q2_yoy AS ( SELECT s1.manufacturer, s1.year_value AS current_year, s1.total_sales_value AS current_sales, s2.total_sales_value AS previous_sales, ((s1.total_sales_value - s2.total_sales_value) / s2.total_sales_value) * 100 AS yoy_change FROM sales_q2 s1 JOIN sales_q2 s2 ON s1.manufacturer = s2.manufacturer AND s1.year_value = s2.year_value + 1 WHERE s1.year_value = 2024 ) SELECT manufacturer, current_sales, previous_sales, yoy_change, current_year - 1 || ' - ' || current_year AS comparison_period FROM sales_q2_yoy ORDER BY yoy_change DESC;"}
{"question": "What is the monthly sales units per manufacturer?", "sql": "SELECT year_value, strftime('%m', month_445) AS month, manufacturer, SUM(sales_units) AS total_units FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), manufacturer ORDER BY year_value, month, manufacturer;"}
{"question": "What is the total monthly sales units across all manufacturers?", "sql": "SELECT year_value, strftime('%m', month_445) AS month, SUM(sales_units) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445) ORDER BY year_value, month;"}
{"question": "List monthly units with total units (using window function)", "sql": "WITH monthly_units AS ( SELECT year_value, strftime('%m', month_445) AS month, manufacturer, SUM(sales_units) AS total_units, SUM(SUM(sales_units)) OVER (PARTITION BY year_value, strftime('%m', month_445)) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), manufacturer ) SELECT * FROM monthly_units ORDER BY year_value, month, manufacturer;"}
{"question": "How is Colgate's unit SOM per month compare to competitors?", "sql": "WITH monthly_units AS ( SELECT year_value, strftime('%m', month_445) AS month, manufacturer, SUM(sales_units) AS total_units, SUM(SUM(sales_units)) OVER (PARTITION BY year_value, strftime('%m', month_445)) AS total_units_all FROM colgate WHERE year_value = strftime('%Y', 'now') AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), manufacturer ) SELECT year_value, month, manufacturer, total_units, total_units_all, (total_units * 100.0) / total_units_all AS unit_share FROM monthly_units ORDER BY year_value, month, unit_share DESC;"}
{"question": "Filter P&G data", "sql": "SELECT * FROM colgate WHERE manufacturer = 'P&G' AND market_desc = 'Total US xAOC';"}
{"question": "List total sales per brand per year", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'P&G' AND market_desc = 'Total US xAOC' GROUP BY brand, year_value ) SELECT * FROM brand_sales ORDER BY brand, year_value;"}
{"question": "List Start year, end year, and number of years for each brand", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'P&G' AND market_desc = 'Total US xAOC' GROUP BY brand, year_value ), brand_years AS ( SELECT brand, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM brand_sales GROUP BY brand ) SELECT * FROM brand_years ORDER BY brand;"}
{"question": "List start sales and end sales for each brand", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'P&G' AND market_desc = 'Total US xAOC' GROUP BY brand, year_value ), brand_years AS ( SELECT brand, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM brand_sales GROUP BY brand ), brand_sales_growth AS ( SELECT b_years.brand, b_years.start_year, b_years.end_year, b_years.num_years, bs_start.total_sales AS start_sales, bs_end.total_sales AS end_sales FROM brand_years b_years JOIN brand_sales bs_start ON b_years.brand = bs_start.brand AND b_years.start_year = bs_start.year_value JOIN brand_sales bs_end ON b_years.brand = bs_end.brand AND b_years.end_year = bs_end.year_value ) SELECT * FROM brand_sales_growth ORDER BY brand;"}
{"question": "Calculate CAGR for each brand and show in descending order.", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY brand, year_value ), brand_years AS ( SELECT brand, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM brand_sales GROUP BY brand ), brand_sales_growth AS ( SELECT b_years.brand, b_years.start_year, b_years.end_year, b_years.num_years, bs_start.total_sales AS start_sales, bs_end.total_sales AS end_sales FROM brand_years b_years JOIN brand_sales bs_start ON b_years.brand = bs_start.brand AND b_years.start_year = bs_start.year_value JOIN brand_sales bs_end ON b_years.brand = bs_end.brand AND b_years.end_year = bs_end.year_value ) SELECT brand, start_sales, end_sales, num_years, (POW((end_sales * 1.0 / start_sales), (1.0 / num_years)) - 1) * 100 AS cagr FROM brand_sales_growth WHERE start_sales > 0 ORDER BY cagr DESC;"}
{"question": "What brands are driving $ growth for UNILEVER?", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'UNILEVER' AND market_desc = 'Total US xAOC' GROUP BY brand, year_value ), brand_years AS ( SELECT brand, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM brand_sales GROUP BY brand ), brand_sales_growth AS ( SELECT b_years.brand, b_years.start_year, b_years.end_year, b_years.num_years, bs_start.total_sales AS start_sales, bs_end.total_sales AS end_sales FROM brand_years b_years JOIN brand_sales bs_start ON b_years.brand = bs_start.brand AND b_years.start_year = bs_start.year_value JOIN brand_sales bs_end ON b_years.brand = bs_end.brand AND b_years.end_year = bs_end.year_value ) SELECT brand, start_sales, end_sales, num_years, (POW((end_sales * 1.0 / start_sales), (1.0 / num_years)) - 1) * 100 AS cagr FROM brand_sales_growth WHERE start_sales > 0 ORDER BY cagr DESC;"}
{"question": "Filter Colgate data", "sql": "SELECT * FROM colgate WHERE manufacturer = 'COLGATE';"}
{"question": "What brands are driving $ growth for Colgate?", "sql": "WITH brand_sales AS ( SELECT brand, year_value, SUM(sales_value) AS total_sales FROM colgate WHERE manufacturer = 'COLGATE' AND market_desc = 'Total US xAOC' GROUP BY brand, year_value ), brand_years AS ( SELECT brand, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM brand_sales GROUP BY brand ), brand_sales_growth AS ( SELECT b_years.brand, b_years.start_year, b_years.end_year, b_years.num_years, bs_start.total_sales AS start_sales, bs_end.total_sales AS end_sales FROM brand_years b_years JOIN brand_sales bs_start ON b_years.brand = bs_start.brand AND b_years.start_year = bs_start.year_value JOIN brand_sales bs_end ON b_years.brand = bs_end.brand AND b_years.end_year = bs_end.year_value ) SELECT brand, start_sales, end_sales, num_years, (POW((end_sales * 1.0 / start_sales), (1.0 / num_years)) - 1) * 100 AS cagr FROM brand_sales_growth WHERE start_sales > 0 ORDER BY cagr DESC;"}
{"question": "Filter Crest 3D White in Target", "sql": "SELECT * FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Target Total BM/FF TA';"}
{"question": "What is the monthly sales value and units for Crest 3D White in Target?", "sql": "SELECT year_value, strftime('%m', month_445) AS month, brand, subbrand, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), brand, subbrand ORDER BY year_value, month, subbrand;"}
{"question": "What is the average price per unit calculation for crest 3D white?", "sql": "WITH brand_data AS ( SELECT year_value, strftime('%m', month_445) AS month, brand, subbrand, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), brand, subbrand ) SELECT year_value, month, brand, subbrand, total_sales_value * 1.0 / total_sales_units AS avg_price_per_unit FROM brand_data ORDER BY year_value, month, subbrand;"}
{"question": "What is the year-over-year price change calculation for crest 3d white?", "sql": "WITH brand_data AS ( SELECT year_value, strftime('%m', month_445) AS month, brand, subbrand, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY year_value, strftime('%m', month_445), brand, subbrand ), price_data AS ( SELECT year_value, month, brand, subbrand, total_sales_value * 1.0 / total_sales_units AS avg_price_per_unit FROM brand_data ) SELECT current_year.year_value, current_year.month, current_year.subbrand, current_year.avg_price_per_unit AS current_price, prev_year.avg_price_per_unit AS prev_year_price, (current_year.avg_price_per_unit - prev_year.avg_price_per_unit) / prev_year.avg_price_per_unit * 100 AS yoy_price_change_percent FROM price_data current_year LEFT JOIN price_data prev_year ON current_year.subbrand = prev_year.subbrand AND current_year.month = prev_year.month AND current_year.year_value = prev_year.year_value + 1 ORDER BY current_year.year_value, current_year.month, current_year.subbrand;"}
{"question": "How has pricing changed over time for Colgate MAX Franchise brand in Target?", "sql": "WITH brand_data AS ( SELECT year_value, strftime('%m', month_445) AS month, brand, subbrand, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE brand = 'COLGATE MAX FRANCHISE' AND market_desc = 'Target Total BM/FF TA' GROUP BY year_value, strftime('%m', month_445), brand, subbrand ) SELECT year_value, month, brand, subbrand, total_sales_value * 1.0 / total_sales_units AS avg_price_per_unit FROM brand_data ORDER BY year_value, month;"}
{"question": "State the yearly sales data and average price per unit for each product", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY item, long_desc, year_value ) SELECT * FROM product_data ORDER BY item, year_value;"}
{"question": "State the start year, end year, and number of years for each product", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY item, long_desc, year_value ), product_years AS ( SELECT item, long_desc, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM product_data GROUP BY item, long_desc ) SELECT * FROM product_years ORDER BY item;"}
{"question": "State the start price and end price for each product", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY item, long_desc, year_value ), product_years AS ( SELECT item, long_desc, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM product_data GROUP BY item, long_desc ), product_price_growth AS ( SELECT py.item, py.long_desc, py.start_year, py.end_year, py.num_years, pd_start.avg_price_per_unit AS start_price, pd_end.avg_price_per_unit AS end_price FROM product_years py JOIN product_data pd_start ON py.item = pd_start.item AND py.start_year = pd_start.year_value JOIN product_data pd_end ON py.item = pd_end.item AND py.end_year = pd_end.year_value ) SELECT * FROM product_price_growth ORDER BY item;"}
{"question": "Which CREST 3D WHITE products have had the most drastic price increases?", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE brand = 'CREST 3D WHITE' AND market_desc = 'Total US xAOC' GROUP BY item, long_desc, year_value ), product_years AS ( SELECT item, long_desc, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM product_data GROUP BY item, long_desc ), product_price_growth AS ( SELECT py.item, py.long_desc, py.start_year, py.end_year, py.num_years, pd_start.avg_price_per_unit AS start_price, pd_end.avg_price_per_unit AS end_price FROM product_years py JOIN product_data pd_start ON py.item = pd_start.item AND py.start_year = pd_start.year_value JOIN product_data pd_end ON py.item = pd_end.item AND py.end_year = pd_end.year_value ) SELECT item, long_desc, start_price, end_price, num_years, (POW((end_price * 1.0 / start_price), (1.0 / num_years)) - 1) * 100 AS cagr FROM product_price_growth WHERE start_price > 0 ORDER BY cagr DESC;"}
{"question": "Which products have had the most drastic price increases in Target?", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE market_desc = 'Target Total BM/FF TA' GROUP BY item, long_desc, year_value ), product_years AS ( SELECT item, long_desc, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM product_data GROUP BY item, long_desc ), product_price_growth AS ( SELECT py.item, py.long_desc, py.start_year, py.end_year, py.num_years, pd_start.avg_price_per_unit AS start_price, pd_end.avg_price_per_unit AS end_price FROM product_years py JOIN product_data pd_start ON py.item = pd_start.item AND py.start_year = pd_start.year_value JOIN product_data pd_end ON py.item = pd_end.item AND py.end_year = pd_end.year_value ) SELECT item, long_desc, start_price, end_price, num_years, (POW((end_price * 1.0 / start_price), (1.0 / num_years)) - 1) * 100 AS cagr FROM product_price_growth WHERE start_price > 0 ORDER BY cagr DESC;"}
{"question": "Which products have had the most drastic price decreases?", "sql": "WITH product_data AS ( SELECT item, long_desc, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_value) * 1.0 / SUM(sales_units) AS avg_price_per_unit FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY item, long_desc, year_value ), product_years AS ( SELECT item, long_desc, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM product_data GROUP BY item, long_desc ), product_price_growth AS ( SELECT py.item, py.long_desc, py.start_year, py.end_year, py.num_years, pd_start.avg_price_per_unit AS start_price, pd_end.avg_price_per_unit AS end_price FROM product_years py JOIN product_data pd_start ON py.item = pd_start.item AND py.start_year = pd_start.year_value JOIN product_data pd_end ON py.item = pd_end.item AND py.end_year = pd_end.year_value ) SELECT item, long_desc, start_price, end_price, num_years, (POW((end_price * 1.0 / start_price), (1.0 / num_years)) - 1) * 100 AS cagr FROM product_price_growth WHERE start_price > 0 ORDER BY cagr ASC;"}
{"question": "Filter Crest data in Family Dollar", "sql": "SELECT * FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA';"}
{"question": "Filter March 2024 Crest data in Family Dollar", "sql": "SELECT * FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA' AND year_value = 2024 AND strftime('%m', month_445) = '03';"}
{"question": "Filter for Crest products in Family Dollar with promotional sales", "sql": "SELECT * FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA' AND year_value = 2024 AND strftime('%m', month_445) = '03' AND promo_sales_units > 0;"}
{"question": "Select distinct Crest products in Family Dollar on promotion", "sql": "SELECT DISTINCT item, long_desc FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA' AND year_value = 2024 AND strftime('%m', month_445) = '03' AND promo_sales_units > 0 ORDER BY item, long_desc;"}
{"question": "Which products from Crest were on promo in Family Dollar in March 2024?", "sql": "SELECT DISTINCT item, long_desc FROM colgate WHERE franchise = 'CREST' AND year_value = 2024 AND strftime('%m', month_445) = '03' AND promo_sales_units > 0 AND market_desc = 'Family Dollar Total TA' ORDER BY item, long_desc;"}
{"question": "Filter for Crest products in Family Dollar that are multi-packs", "sql": "SELECT * FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA' AND year_value = 2024 AND strftime('%m', month_445) = '03' AND promo_sales_units > 0 AND multi_pack = 'MULTI';"}
{"question": "Select distinct multi-pack Crest products in Family Dollar on promotion", "sql": "SELECT DISTINCT item, long_desc, size FROM colgate WHERE franchise = 'CREST' AND market_desc = 'Family Dollar Total TA' AND year_value = 2024 AND strftime('%m', month_445) = '03' AND promo_sales_units > 0 AND multi_pack = 'MULTI' ORDER BY item, long_desc, size;"}
{"question": "Calculate total sales units for each SKU in each market", "sql": "WITH market_sku_sales AS ( SELECT market_desc, item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, item, long_desc ) SELECT * FROM market_sku_sales ORDER BY market_desc, total_sales_units DESC;"}
{"question": "Calculate total sales units for each market", "sql": "WITH market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ) SELECT * FROM market_total_sales ORDER BY total_market_units DESC;"}
{"question": "Calculate unit share for each SKU in each market", "sql": "WITH market_sku_sales AS ( SELECT market_desc, item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, item, long_desc ), market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ), market_sku_share AS ( SELECT s.market_desc, s.item, s.long_desc, s.total_sales_units, t.total_market_units, (s.total_sales_units * 1.0 / t.total_market_units) * 100 AS unit_share FROM market_sku_sales s JOIN market_total_sales t ON s.market_desc = t.market_desc ) SELECT * FROM market_sku_share ORDER BY market_desc, unit_share DESC;"}
{"question": "Rank SKUs within each market based on unit share", "sql": "WITH market_sku_sales AS ( SELECT market_desc, item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, item, long_desc ), market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ), market_sku_share AS ( SELECT s.market_desc, s.item, s.long_desc, s.total_sales_units, t.total_market_units, (s.total_sales_units * 1.0 / t.total_market_units) * 100 AS unit_share FROM market_sku_sales s JOIN market_total_sales t ON s.market_desc = t.market_desc ), ranked_skus AS ( SELECT market_desc, item, long_desc, total_sales_units, unit_share, RANK() OVER (PARTITION BY market_desc ORDER BY unit_share DESC) AS rank FROM market_sku_share ) SELECT * FROM ranked_skus ORDER BY market_desc, rank;"}
{"question": "Select top performing SKU for each market", "sql": "WITH market_sku_sales AS ( SELECT market_desc, item, long_desc, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, item, long_desc ), market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ), market_sku_share AS ( SELECT s.market_desc, s.item, s.long_desc, s.total_sales_units, t.total_market_units, (s.total_sales_units * 1.0 / t.total_market_units) * 100 AS unit_share FROM market_sku_sales s JOIN market_total_sales t ON s.market_desc = t.market_desc ), ranked_skus AS ( SELECT market_desc, item, long_desc, total_sales_units, unit_share, RANK() OVER (PARTITION BY market_desc ORDER BY unit_share DESC) AS rank FROM market_sku_share ) SELECT market_desc, item, long_desc, total_sales_units, unit_share FROM ranked_skus WHERE rank = 1 ORDER BY market_desc;"}
{"question": "Rank variants within each market based on unit share", "sql": "WITH market_variant_sales AS ( SELECT market_desc, variant, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, variant ), market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ), market_variant_share AS ( SELECT s.market_desc, s.variant, s.total_sales_units, t.total_market_units, (s.total_sales_units * 1.0 / t.total_market_units) * 100 AS unit_share FROM market_variant_sales s JOIN market_total_sales t ON s.market_desc = t.market_desc ), ranked_variants AS ( SELECT market_desc, variant, total_sales_units, unit_share, RANK() OVER (PARTITION BY market_desc ORDER BY unit_share DESC) AS rank FROM market_variant_share ) SELECT * FROM ranked_variants ORDER BY market_desc, rank;"}
{"question": "Select top performing variant for each market", "sql": "WITH market_variant_sales AS ( SELECT market_desc, variant, SUM(sales_units) AS total_sales_units FROM colgate GROUP BY market_desc, variant ), market_total_sales AS ( SELECT market_desc, SUM(sales_units) AS total_market_units FROM colgate GROUP BY market_desc ), market_variant_share AS ( SELECT s.market_desc, s.variant, s.total_sales_units, t.total_market_units, (s.total_sales_units * 1.0 / t.total_market_units) * 100 AS unit_share FROM market_variant_sales s JOIN market_total_sales t ON s.market_desc = t.market_desc ), ranked_variants AS ( SELECT market_desc, variant, total_sales_units, unit_share, RANK() OVER (PARTITION BY market_desc ORDER BY unit_share DESC) AS rank FROM market_variant_share ) SELECT market_desc, variant, total_sales_units, unit_share FROM ranked_variants WHERE rank = 1 ORDER BY market_desc;"}
{"question": "Calculate total sales value, units, and volume for each segment by year", "sql": "WITH segment_sales AS ( SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value ) SELECT * FROM segment_sales ORDER BY segment, year_value;"}
{"question": "Determine start year, end year, and number of years for each segment", "sql": "WITH segment_sales AS ( SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value ), segment_years AS ( SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment ) SELECT * FROM segment_years ORDER BY segment;"}
{"question": "Join start and end year data for each segment", "sql": "WITH segment_sales AS ( SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value ), segment_years AS ( SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment ), segment_start_end AS ( SELECT sy.segment, sy.start_year, sy.end_year, sy.num_years, ss_start.total_sales_value AS start_sales_value, ss_end.total_sales_value AS end_sales_value, ss_start.total_sales_units AS start_sales_units, ss_end.total_sales_units AS end_sales_units, ss_start.total_sales_volume AS start_sales_volume, ss_end.total_sales_volume AS end_sales_volume FROM segment_years sy JOIN segment_sales ss_start ON sy.segment = ss_start.segment AND sy.start_year = ss_start.year_value JOIN segment_sales ss_end ON sy.segment = ss_end.segment AND sy.end_year = ss_end.year_value ) SELECT * FROM segment_start_end ORDER BY segment;"}
{"question": "How are segments growing in terms of sales value, sales units, and sales volume for Target?", "sql": "WITH segment_sales AS ( SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Target Total BM/FF TA' GROUP BY segment, year_value ), segment_years AS ( SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment ), segment_start_end AS ( SELECT sy.segment, sy.start_year, sy.end_year, sy.num_years, ss_start.total_sales_value AS start_sales_value, ss_end.total_sales_value AS end_sales_value, ss_start.total_sales_units AS start_sales_units, ss_end.total_sales_units AS end_sales_units, ss_start.total_sales_volume AS start_sales_volume, ss_end.total_sales_volume AS end_sales_volume FROM segment_years sy JOIN segment_sales ss_start ON sy.segment = ss_start.segment AND sy.start_year = ss_start.year_value JOIN segment_sales ss_end ON sy.segment = ss_end.segment AND sy.end_year = ss_end.year_value ) SELECT segment, num_years, start_sales_value, end_sales_value, (POW((end_sales_value * 1.0 / start_sales_value), (1.0 / num_years)) - 1) * 100 AS cagr_sales_value, start_sales_units, end_sales_units, (POW((end_sales_units * 1.0 / start_sales_units), (1.0 / num_years)) - 1) * 100 AS cagr_sales_units, start_sales_volume, end_sales_volume, (POW((end_sales_volume * 1.0 / start_sales_volume), (1.0 / num_years)) - 1) * 100 AS cagr_sales_volume FROM segment_start_end WHERE start_sales_value > 0 AND start_sales_units > 0 AND start_sales_volume > 0 ORDER BY cagr_sales_value DESC;"}
{"question": "Calculate total sales units for each segment by year", "sql": "SELECT segment, year_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value;"}
{"question": "Calculate CAGR for sales units for segments.", "sql": "WITH segment_sales AS (SELECT segment, year_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value), segment_years AS (SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment), segment_start_end AS (SELECT sy.segment, sy.start_year, sy.end_year, sy.num_years, ss_start.total_sales_units AS start_sales_units, ss_end.total_sales_units AS end_sales_units FROM segment_years sy JOIN segment_sales ss_start ON sy.segment = ss_start.segment AND sy.start_year = ss_start.year_value JOIN segment_sales ss_end ON sy.segment = ss_end.segment AND sy.end_year = ss_end.year_value) SELECT segment, num_years, start_sales_units, end_sales_units, (POW((end_sales_units * 1.0 / start_sales_units), (1.0 / num_years)) - 1) * 100 AS cagr_sales_units FROM segment_start_end WHERE start_sales_units > 0 ORDER BY cagr_sales_units DESC;"}
{"question": "Compare segments growing for sales units.", "sql": "WITH segment_sales AS (SELECT segment, year_value, SUM(sales_units) AS total_sales_units FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value), segment_years AS (SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment), segment_start_end AS (SELECT sy.segment, sy.start_year, sy.end_year, sy.num_years, ss_start.total_sales_units AS start_sales_units, ss_end.total_sales_units AS end_sales_units FROM segment_years sy JOIN segment_sales ss_start ON sy.segment = ss_start.segment AND sy.start_year = ss_start.year_value JOIN segment_sales ss_end ON sy.segment = ss_end.segment AND sy.end_year = ss_end.year_value) SELECT segment, num_years, start_sales_units, end_sales_units, (POW((end_sales_units * 1.0 / start_sales_units), (1.0 / num_years)) - 1) * 100 AS cagr_sales_units FROM segment_start_end WHERE start_sales_units > 0 ORDER BY cagr_sales_units DESC;"}
{"question": "Calculate sales velocity for Colgate Optic White products in Target", "sql": "WITH optic_white_prods AS ( SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'Target Total BM/FF TA' AND year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc ), sales_velocity_calculation AS ( SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value * 1.0 / tdp END AS sales_velocity FROM optic_white_prods ) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "Filter and aggregate data for Colgate Optic White products in ShopRite for 2024", "sql": "WITH optic_white_prods AS ( SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'ShopRite Total TA' AND year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc ) SELECT * FROM optic_white_prods;"}
{"question": "Calculate sales velocity for Colgate Optic White products in ShopRite for 2024", "sql": "WITH optic_white_prods AS ( SELECT year_value, item, market_desc, brand, subbrand, long_desc, SUM(acv) AS tdp, SUM(sales_value) AS total_sales_value FROM colgate WHERE brand = 'COLGATE OPTIC WHITE' AND market_desc = 'ShopRite Total TA' AND year_value = 2024 GROUP BY year_value, item, market_desc, brand, subbrand, long_desc ), sales_velocity_calculation AS ( SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, CASE WHEN tdp = 0 THEN 0 ELSE total_sales_value * 1.0 / tdp END AS sales_velocity FROM optic_white_prods ) SELECT year_value, item, market_desc, brand, subbrand, long_desc, total_sales_value, tdp, sales_velocity FROM sales_velocity_calculation ORDER BY sales_velocity DESC;"}
{"question": "Calculate CAGR for sales value, units, and volume", "sql": "WITH segment_sales AS ( SELECT segment, year_value, SUM(sales_value) AS total_sales_value, SUM(sales_units) AS total_sales_units, SUM(sales_volume) AS total_sales_volume FROM colgate WHERE market_desc = 'Total US xAOC' GROUP BY segment, year_value ), segment_years AS ( SELECT segment, MIN(year_value) AS start_year, MAX(year_value) AS end_year, MAX(year_value) - MIN(year_value) + 1 AS num_years FROM segment_sales GROUP BY segment ), segment_start_end AS ( SELECT sy.segment, sy.start_year, sy.end_year, sy.num_years, ss_start.total_sales_value AS start_sales_value, ss_end.total_sales_value AS end_sales_value, ss_start.total_sales_units AS start_sales_units, ss_end.total_sales_units AS end_sales_units, ss_start.total_sales_volume AS start_sales_volume, ss_end.total_sales_volume AS end_sales_volume FROM segment_years sy JOIN segment_sales ss_start ON sy.segment = ss_start.segment AND sy.start_year = ss_start.year_value JOIN segment_sales ss_end ON sy.segment = ss_end.segment AND sy.end_year = ss_end.year_value ) SELECT segment, num_years, start_sales_value, end_sales_value, (POW((end_sales_value * 1.0 / start_sales_value), (1.0 / num_years)) - 1) * 100 AS cagr_sales_value, start_sales_units, end_sales_units, (POW((end_sales_units * 1.0 / start_sales_units), (1.0 / num_years)) - 1) * 100 AS cagr_sales_units, start_sales_volume, end_sales_volume, (POW((end_sales_volume * 1.0 / start_sales_volume), (1.0 / num_years)) - 1) * 100 AS cagr_sales_volume FROM segment_start_end WHERE start_sales_value > 0 AND start_sales_units > 0 AND start_sales_volume > 0 ORDER BY cagr_sales_value DESC;"}